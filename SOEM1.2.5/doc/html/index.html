<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SOEM: Simple Open EtherCAT Master or SOEM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SOEM&#160;<span id="projectnumber">v1.2.5</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Simple Open EtherCAT Master or SOEM </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="overview"></a>
Overview</h2>
<p>SOEM is an EtherCAT master library written in c. Its purpose is to learn and to use. All users are invited to study the source to get an understanding how an EtherCAT master functions and how it interacts with EtherCAT slaves.</p>
<p>As all applications are different SOEM tries to not impose any design architecture. It can be used in generic user mode, PREEMPT_RT or Xenomai.</p>
<p>Preconditions :</p>
<ul>
<li>Linux 2.6 kernel.</li>
<li>GCC compiler (others might work, just not tested).</li>
<li>One (or two if in redundant mode) 100Mb/s NIC that can connect to a RAW socket.</li>
<li>Application must run as root / kernel.</li>
</ul>
<p>Features as of 1.1.2 :</p>
<ul>
<li>Connects to a standard RAW socket.</li>
<li>Full redundancy support.</li>
<li>Recovery of "out-of-order" frames.</li>
<li>Low level functions, BRD, BWR, APRMW, FPRD, LRW....</li>
<li>Blocking or non blocking transfers.</li>
<li>Automatic configuration of slaves.</li>
<li>Use of internal configuration table (quick).</li>
<li>Use of slave internal data in EEprom and/or CoE.</li>
<li>Setting and reading of slave state.</li>
<li>Automatic generation of processdata mapping.</li>
<li>Mailbox link layer support with resend toggle.</li>
<li>CoE, SDO read / write.</li>
<li>CoE, Complete Access support.</li>
<li>CoE, Segmented transfer support.</li>
<li>CoE, Object Description list</li>
<li>CoE, Emergency and abort SDO support.</li>
<li>Distributed Clock (DC) support.</li>
<li>Automatic configuration of DC slaves.</li>
<li>Automatic sync of clocks with process data exchange.</li>
<li>Flexible settting of sync0 and sync1 firing per slave.</li>
<li>Access to slave functions through one slave structure.</li>
<li>EEPROM read / write.</li>
<li>Local cache for EEPROM access with automatic 4/8 byte reading.</li>
<li>SII parsing.</li>
<li>Portable code, only standard c, usable for embedded applications.</li>
<li>All buffers are static so can be memory locked.</li>
<li>Support for Little and Big endian targets.</li>
</ul>
<p>Features as of 1.1.3 :</p>
<ul>
<li>CoE, TxPDO and RxPDO, master is client (beta).</li>
<li>FoE, Read and Write file (beta).</li>
</ul>
<p>Features as of 1.1.4 :</p>
<ul>
<li>FMMU allocation is floating instead of fixed. If needed more than 2 FMMUs are used.</li>
<li>SYNC1 generation supported.</li>
</ul>
<p>Features as of 1.2.0 :</p>
<ul>
<li>Changed license to GPLv2 only. Adresses leagal concerns about master licensing.</li>
<li>Slave init and process data mapping is split in two functions. This allows dynamic user reconfiguration of PDO mapping.</li>
<li>Eeprom transfer to and from PDI</li>
<li>Eeprom is released to PDI when going to SAFEOP.</li>
</ul>
<p>Features as of 1.2.2 :</p>
<ul>
<li>Redesign of topology and delay measurement. 4 port slaves are fully supported now.</li>
<li>Delay measurement of slaves that are reverse connected work too.</li>
<li>New ethercatprint unit to display errors in readable text.</li>
</ul>
<p>Features as of 1.2.4 :</p>
<ul>
<li>SoE, servo over EtherCAT support.</li>
<li>SoE read request and write request.</li>
<li>SoE segmented transfers.</li>
<li>SoE error response.</li>
<li>Added SoE errors to print module.</li>
<li>Auto config of SoE process data.</li>
</ul>
<p>Features as of 1.2.5 :</p>
<ul>
<li>Added eepromtool, it can read and write the ESC eeprom of a designated slave.</li>
<li>Rewrite of eeprom read/write functions.</li>
<li>Added infrastructure change to allow slave groups.</li>
<li>Added recovery and reconfiguration of slaves after connection loss.</li>
<li>Improved CoE PDO assignment read from slaves, no longer assume assign indexes as functionally fixed.</li>
</ul>
<h2><a class="anchor" id="start"></a>
Getting started</h2>
<p>For examples see <a class="el" href="simple__test_8c.html" title="Example code for Simple Open EtherCAT master.">simple_test.c</a> in ~/src. First try (assume EtherCAT on eth0): sudo ./simple_test eth0 As SOEM uses RAW sockets it will need to run as root.</p>
<h2><a class="anchor" id="bugs"></a>
Squashed bugs</h2>
<p>Version 1.1.3</p>
<ul>
<li>Added missing Big-Endian conversion in <a class="el" href="ethercatconfig_8c.html" title="Configuration module for EtherCAT master.">ethercatconfig.c</a></li>
<li>Fixed bug in segmented SDO transfers in <a class="el" href="ethercatcoe_8c.html" title="CAN over EtherCAT (CoE) module.">ethercatcoe.c</a></li>
</ul>
<p>Version 1.1.4</p>
<ul>
<li>Changed FMMU algorithm of allocation during configuration. EL4732 supported now.</li>
<li>Changed the ec_slave structure around SM en FMMU storage.</li>
<li>Fixed bug in FoE write in <a class="el" href="ethercatfoe_8c.html" title="File over EtherCAT (FoE) module.">ethercatfoe.c</a></li>
</ul>
<p>Version 1.2.0</p>
<ul>
<li>Fixed bug in type definition of int32 and uint32 for 64bit OS.</li>
<li>Fixed bug in maximum dataframe size calculation.</li>
</ul>
<p>Version 1.2.2</p>
<ul>
<li>Fixed bugs in ec_adddatagram.</li>
<li>Fixed several bugs in CoE object dictionary read functions.</li>
<li>Fixed bug in PDO mapping read function.</li>
<li>Changed ec_slave structure around topology and delay variables.</li>
<li>Added several constants in ethercattype.c</li>
</ul>
<p>Version 1.2.3</p>
<ul>
<li>Clear SM enable if size is 0, even if enable is set in SII.</li>
<li>Fixed bug in DC propagation delay calculation. Branches with only non DC slaves now correctly close root port.</li>
<li>Fixed bug in <a class="el" href="ethercatmain_8c.html#a14280050ace4427d196acd17e6d79e55">ec_receive_processdata()</a>, wkc now checks for EC_NOFRAME instead of 0.</li>
<li>Fixed bug in makefile.</li>
</ul>
<p>Version 1.2.5</p>
<ul>
<li>Fixed bugs in <a class="el" href="ethercatconfig_8c.html#aa740a2ba948117670c4f9741bc31cc38">ec_config_map()</a>.</li>
<li>Added EC_STATE_BOOT constant.</li>
<li>Fixed mailbox size bug, In and Out mailbox can now be of different size.</li>
<li>Fixed SM type bug.</li>
<li>Fixed FoE bugs.</li>
<li>Fixed siigetbyte() unaligned copy.</li>
<li>Fixed bug in <a class="el" href="nicdrv_8c.html" title="EtherCAT RAW socket driver.">nicdrv.c</a>, socket handles are 0 included.</li>
<li>Fixed bug in <a class="el" href="ethercatconfig_8c.html" title="Configuration module for EtherCAT master.">ethercatconfig.c</a> causing memory corruption. </li>
</ul>
<h2><a class="anchor" id="legal"></a>
Legal notice</h2>
<p>Copyright© 2005-2011 Speciaal Machinefabriek Ketels v.o.f. <br/>
 Copyright© 2005-2011 Arthur Ketels <br/>
 Copyright© 2008-2010 TU/e Technische Universiteit Eindhoven <br/>
</p>
<p>SOEM is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License version 2 as published by the Free Software Foundation.</p>
<p>SOEM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>As a special exception, if other files instantiate templates or use macros or inline functions from this file, or you compile this file and link it with other works to produce a work based on this file, this file does not by itself cause the resulting work to be covered by the GNU General Public License. However the source code for this file must still be made available in accordance with section (3) of the GNU General Public License.</p>
<p>This exception does not invalidate any other reasons why a work based on this file might be covered by the GNU General Public License.</p>
<p>The EtherCAT Technology, the trade name and logo "EtherCAT" are the intellectual property of, and protected by Beckhoff Automation GmbH. You can use SOEM for the sole purpose of creating, using and/or selling or otherwise distributing an EtherCAT network master provided that an EtherCAT Master License is obtained from Beckhoff Automation GmbH.</p>
<p>In case you did not receive a copy of the EtherCAT Master License along with SOEM write to Beckhoff Automation GmbH, Eiserstrasse 5, D-33415 Verl, Germany (www.beckhoff.com). </p>
</div></div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Jun 13 2011 17:51:13 for SOEM by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
